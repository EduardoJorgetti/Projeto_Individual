<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta id="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz</title>
    <link rel="stylesheet" href="./css/StyleQuizReal.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

</head>

<body class="bg-img-body">
    <h1>Quiz</h1>
    <div class="quiz">
        <div class="container">
            <p id="p" style="display: block;">RESPONDA AS QUESTÕES CORRETAMENTE PARA ACUMULAR PONTOS!</p>
            <div class="questao" id="questao_um" style="display: block;">
                <label for="q1">A primeira medalha de ouro olímpica da história do volei brasileiro foi em...</label>
                <ul>
                    <li style="list-style: none;"><input class="pergunta" type="radio" name="q1" id="q1_inp"
                            value="0">1996</li>
                    <li style="list-style: none;"><input class="pergunta" type="radio" name="q1" id="q1_inp"
                            value="1">1992</li>
                    <li style="list-style: none;"><input class="pergunta" type="radio" name="q1" id="q1_inp"
                            value="0">1988</li>
                    <li style="list-style: none;"><input class="pergunta" type="radio" name="q1" id="q1_inp"
                            value="0">2000</li>
                </ul>
                <button class="botaoquiz" id="btn-salvar" type="submit" onclick="resposta()">Confirmar resposta</button>
            </div>
            <div class="questao" id="questao_dois" style="display: none;">
                <label for="q2">O atual levantador da seleção masculina é:</label>
                <ul>
                    <li style="list-style: none;"><input class="pergunta" type="radio" name="q2" id="q2_inp"
                            value="0">Lucarelli</li>
                    <li style="list-style: none;"><input class="pergunta" type="radio" name="q2" id="q2_inp"
                            value="0">Dante</li>
                    <li style="list-style: none;"><input class="pergunta" type="radio" name="q2" id="q2_inp"
                            value="1">Bruninho</li>
                    <li style="list-style: none;"><input class="pergunta" type="radio" name="q2" id="q2_inp"
                            value="0">Giba</li>
                </ul>
                <button class="botaoquiz" id="btn-salvar" type="submit" onclick="resposta()">Confirmar resposta</button>
            </div>
            <div class="questao" id="questao_tres" style="display: none;">
                <label for="q3">A atual capitã da seleção feminina é a:</label>
                <ul>
                    <li style="list-style: none;"><input class="pergunta" type="radio" name="q3" id="q3_inp"
                            value="0">Pri Daroit</li>
                    <li style="list-style: none;"><input class="pergunta" type="radio" name="q3" id="q3_inp"
                            value="0">Macris</li>
                    <li style="list-style: none;"><input class="pergunta" type="radio" name="q3" id="q3_inp"
                            value="0">Carolana</li>
                    <li style="list-style: none;"><input class="pergunta" type="radio" name="q3" id="q3_inp"
                            value="1">Gabi</li>
                </ul>
                <button class="botaoquiz" id="btn-salvar" type="submit" onclick="resposta()">Confirmar resposta</button>
            </div>
            <div class="questao" id="questao_quatro" style="display: none;">
                <label for="q4">Juntando as 2 seleções, em Olimpíadas o Brasil possui:</label>
                <ul>
                    <li style="list-style: none;"><input class="pergunta" type="radio" name="q4" id="q4_inp" value="1">5
                        medalhas de ouro e 4 de
                        prata</li>
                    <li style="list-style: none;"><input class="pergunta" type="radio" name="q4" id="q4_inp" value="0">4
                        medalhas de ouro e 4 de
                        prata</li>
                    <li style="list-style: none;"><input class="pergunta" type="radio" name="q4" id="q4_inp" value="0">4
                        medalhas de ouro e 5 de
                        prata</li>
                    <li style="list-style: none;"><input class="pergunta" type="radio" name="q4" id="q4_inp" value="0">5
                        medalhas de ouro e 5 de
                        prata</li>
                </ul>
                <button class="botaoquiz" id="btn-salvar" type="submit" onclick="resposta()">Confirmar resposta</button>
            </div>
            <div class="questao" id="questao_cinco" style="display: none;">
                <label for="q5">Quem revolucionou a posição de líbero no Brasil?</label>
                <ul>
                    <li style="list-style: none;"><input class="pergunta" type="radio" name="q5" id="q5_inp"
                            value="0">Rodrigão</li>
                    <li style="list-style: none;"><input class="pergunta" type="radio" name="q5" id="q5_inp"
                            value="0">Dante</li>
                    <li style="list-style: none;"><input class="pergunta" type="radio" name="q5" id="q5_inp"
                            value="1">Serginho</li>
                    <li style="list-style: none;"><input class="pergunta" type="radio" name="q5" id="q5_inp"
                            value="0">Giba</li>
                </ul>
                <button class="botaoquiz" id="btn-salvar" type="submit" onclick="resposta()">Confirmar resposta</button>
            </div>
            <div class="questao" id="questao_seis" style="display: none;">
                <label for="q6">Qual(is) jogadora(s) brasileiras fazem parte do atual TOP 5 mundial?</label>
                <ul>
                    <li style="list-style: none;"><input class="pergunta" type="radio" name="q6" id="q6_inp"
                            value="1">Carolana e Gabi</li>
                    <li style="list-style: none;"><input class="pergunta" type="radio" name="q6" id="q6_inp"
                            value="0">Macris e Pri Daroit</li>
                    <li style="list-style: none;"><input class="pergunta" type="radio" name="q6" id="q6_inp"
                            value="0">Gabi e Pri Daroit</li>
                    <li style="list-style: none;"><input class="pergunta" type="radio" name="q6" id="q6_inp"
                            value="0">Gabi</li>
                </ul>
                <button class="botaoquiz" id="btn-salvar" type="submit" onclick="resposta()">Confirmar resposta</button>
            </div>
            <div class="questao" id="questao_sete" style="display: none;">
                <label for="q7">A seleção masculina e feminina ocupam, respectivamente, que posições no ranking
                    mundial?</label>
                <ul>
                    <li style="list-style: none;"><input class="pergunta" type="radio" name="q7" id="q7_inp"
                            value="0">1ª e 2ª colocações</li>
                    <li style="list-style: none;"><input class="pergunta" type="radio" name="q7" id="q7_inp"
                            value="0">2ª e 1ª colocações</li>
                    <li style="list-style: none;"><input class="pergunta" type="radio" name="q7" id="q7_inp"
                            value="1">4ª e 3ª colocações</li>
                    <li style="list-style: none;"><input class="pergunta" type="radio" name="q7" id="q7_inp"
                            value="0">4ª e 4ª colocações</li>
                </ul>
                <button class="botaoquiz" id="btn-salvar" type="submit" onclick="resposta()">Confirmar resposta</button>
            </div>
            <div class="questao" id="questao_resposta" style="display: none;">
                <div id="divresult"></div>
            </div>
            <div id="grafico" style="display: none;">
                <div id="chartzinho">
                    <canvas id="myChart"></canvas>
                </div>
            </div>
        </div>
    </div>

    <!--footer inicio-->
    <div class="footer">
        <div class="container">
            <h4>Feito por Eduardo Jorgetti</h4>
        </div>
    </div>
    <!--footer fim-->
</body>

</html>
<script>
    var cont = 1;
    var respostas = [];
    var questao = false;
    var pontos = 0;

    function resposta() {
        for (let index = 1; index <= 7; index++) {

            if (cont == 1) {

                if (document.querySelector('input[name="q1"]:checked').value == 1) {
                    pontos += 2;
                }


                questao_um.style.display = 'none';
                questao_dois.style.display = 'block';
                cont++;
                break;
            }

            if (cont == 2) {

                if (document.querySelector('input[name="q2"]:checked').value == 1) {
                    pontos += 2;
                }


                questao_dois.style.display = 'none';
                questao_tres.style.display = 'block';
                cont++;
                break;
            }

            if (cont == 3) {

                if (document.querySelector('input[name="q3"]:checked').value == 1) {
                    pontos += 2;
                }


                questao_tres.style.display = 'none';
                questao_quatro.style.display = 'block';
                cont++;
                break;
            }

            if (cont == 4) {

                if (document.querySelector('input[name="q4"]:checked').value == 1) {
                    pontos += 2;
                }


                questao_quatro.style.display = 'none';
                questao_cinco.style.display = 'block';
                cont++;
                break;
            }

            if (cont == 5) {

                if (document.querySelector('input[name="q5"]:checked').value == 1) {
                    pontos += 2;
                }


                questao_cinco.style.display = 'none';
                questao_seis.style.display = 'block';
                cont++;
                break;
            }

            if (cont == 6) {

                if (document.querySelector('input[name="q6"]:checked').value == 1) {
                    pontos += 2;
                }


                questao_seis.style.display = 'none';
                questao_sete.style.display = 'block';
                cont++;
                break;
            }

            if (cont == 7) {

                if (document.querySelector('input[name="q7"]:checked').value == 1) {
                    pontos += 2;
                }
                questao_sete.style.display = 'none';
                questao_resposta.style.display = 'block';
                cont = 1;
                resultado();
                break;
            }
        }
    }

    function resultado() {

        if (pontos >= 12) {
            divresult.innerHTML = `Pontos ${pontos}! <br>
                           Parábens, você entende muito sobre a seleção brasileira!`
        } else if (pontos >= 8 && pontos <= 11) {
            divresult.innerHTML = `Pontos ${pontos}! <br>
                           Boa, foi bem!`
        } else {
            divresult.innerHTML = `Pontos ${pontos}! <br>
                           Mandou mal!`
        }

        quiz()
    }

    function quiz() {
        var pontosVar = pontos;
        var idVar = sessionStorage.ID_USUARIO;

        fetch("/usuarios/quiz", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                pontosServer: pontosVar,
                idServer: idVar
            })
        }).then(function (resposta) {

            console.log("resposta: ", resposta);

            if (resposta.ok) {
                alert('Quiz enviado ao bancos')

                grafico.style.display = 'block'


                obterGrafico();
            } else {
                throw ("Houve um erro ao tentar realizar o cadastro!");
            }
        }).catch(function (resposta) {
            console.log(`#ERRO: ${resposta}`);
        });

        // return false;
    }

    function obterGrafico() {

        fetch("/dash/listar").then(function (resposta) {
            if (resposta.ok) {

                resposta.json().then(function (resposta) {
                    console.log("Dados recebidos: ", JSON.stringify(resposta));

                    let data = {
                        labels: [],
                        datasets: [{
                            label: ['Top 5 - Desafio'],
                            backgroundColor: ['#0000CD', '#DAA520', '#fcdf83', '#788cbf', '#838e91'],
                            data: [],
                        }
                        ]
                    };

                    const config = {
                        type: 'bar',
                        data: data,
                        options: {
                            animations: {

                            }
                        }
                    };

                    config.options.animation = false;

                    for (let index = 0; index < resposta.length; index++) {
                        const elemento = resposta[index]
                        data.labels.push(elemento.nome)
                        data.datasets[0].data.push(elemento.acertos)
                    }

                    const myChart = new Chart(
                        document.getElementById('myChart'),
                        config
                    );

                });
            } else {
                throw ('Houve um erro na API!');
            }
        }).catch(function (resposta) {
            console.error(resposta);

        });
    }

</script>